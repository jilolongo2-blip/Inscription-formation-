<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription des Participants</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

    <style>
        :root { --primary-blue: #0a4275; --bg-light: #f4f7f9; }
        body { background: var(--bg-light); font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .card { border: none; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .navbar { background-color: #212529 !important; border-bottom: 3px solid var(--gold); }
        .payment-logo { width: 40px; height: 40px; object-fit: contain; border-radius: 5px; margin-right: 10px; }
        .payment-box { background: #fff; padding: 15px; border-radius: 10px; border-left: 5px solid var(--primary-blue); }
        .badge-price { background: #e67e22; color: white; padding: 8px 15px; border-radius: 50px; font-weight: bold; }
    </style>
</head>
<body>

<nav class="navbar navbar-dark py-3 px-4">
    <div class="container d-flex align-items-center">
        <a class="navbar-brand fw-bold d-flex align-items-center" href="#">
            <img src="IMG_0213.PNG" alt="Logo" style="width: 45px; margin-right: 15px;">
            <span>GESTION DES PARTICIPANTS</span>
        </a>
    </div>
</nav>

<div class="container py-5">
    
    <div class="row g-4">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header bg-primary text-white p-3 fw-bold">
                    <i class="bi bi-person-plus-fill me-2"></i> Formulaire d’inscription
                </div>
                <div class="card-body p-4">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label class="form-label fw-bold">Nom</label>
                            <input type="text" id="nom" class="form-control" placeholder="Entrez le nom">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-bold">Prénom</label>
                            <input type="text" id="prenom" class="form-control" placeholder="Entrez le prénom">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-bold">Postnom</label>
                            <input type="text" id="postnom" class="form-control" placeholder="Entrez le postnom">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-bold">Sexe</label>
                            <select id="sexe" class="form-select">
                                <option value="">-- Choisir --</option>
                                <option>Masculin</option>
                                <option>Féminin</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-bold">Niveau d’études</label>
                            <select id="niveau" class="form-select">
                                <option value="">-- Choisir --</option>
                                <option>Secondaire</option>
                                <option>Graduat</option>
                                <option>Licence</option>
                                <option>Master</option>
                                <option>Doctorat</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-bold">Téléphone</label>
                            <input type="tel" id="telephone" class="form-control" placeholder="+243 ...">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">Profession</label>
                            <input type="text" id="profession" class="form-control" placeholder="Ex: Étudiant, Comptable...">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">Formation choisie</label>
                            <div class="input-group">
                                <input type="text" id="formation" class="form-control fw-bold text-primary" readonly placeholder="Cliquer sur choisir">
                                <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalFormation">
                                    Choisir
                                </button>
                            </div>
                        </div>
                        <div class="col-12 text-end mt-4">
                            <button class="btn btn-success px-5 py-2 fw-bold" onclick="enregistrer()">
                                <i class="bi bi-check-circle me-2"></i> Enregistrer
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card h-100 border-0 bg-white">
                <div class="card-body">
                    <h5 class="fw-bold mb-4 text-primary"><i class="bi bi-wallet2 me-2"></i> Mode de paiement</h5>
                    
                    <div class="payment-box mb-3 shadow-sm">
                        <div class="d-flex align-items-center mb-2">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/Orange_logo.svg/1024px-Orange_logo.svg.png" class="payment-logo" alt="Orange">
                            <span class="fw-bold">Orange Money</span>
                        </div>
                        <p class="small mb-0 text-muted">+243 897 338 150 <br><strong>Solange Kabanga</strong></p>
                    </div>

                    <div class="payment-box mb-3 shadow-sm">
                        <div class="d-flex align-items-center mb-2">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/4/41/M-pesa_logo.png" class="payment-logo" alt="Mpesa">
                            <span class="fw-bold">M-Pesa</span>
                        </div>
                        <p class="small mb-0 text-muted">+243 819 188 580 <br><strong>Pierre Yombo</strong></p>
                    </div>

                    <div class="payment-box mb-3 shadow-sm">
                        <div class="d-flex align-items-center mb-2">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/a/a3/Airtel_logo.png" class="payment-logo" alt="Airtel">
                            <span class="fw-bold">Airtel Money</span>
                        </div>
                        <p class="small mb-0 text-muted">+243 988 708 921 <br><strong>Pierre Yombo</strong></p>
                    </div>

                    <div class="text-center mt-4">
                        <p class="mb-1 text-muted small text-uppercase">Montant de l'inscription</p>
                        <span class="badge-price fs-4">5.00 $ USD</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-12">
            <div class="card shadow-sm mt-2">
                <div class="card-header bg-dark text-white fw-bold d-flex justify-content-between align-items-center p-3">
                    <span><i class="bi bi-list-stars me-2"></i> Liste des participants</span>
                    <button class="btn btn-success btn-sm" onclick="exportExcel()">
                        <i class="bi bi-file-earmark-excel me-1"></i> Exporter Excel
                    </button>
                </div>
                <div class="card-body table-responsive">
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>#</th>
                                <th>Nom complet</th>
                                <th>Téléphone</th>
                                <th>Formation</th>
                                <th class="text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="tableParticipants"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalFormation" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow">
            <div class="modal-header bg-dark text-white">
                <h5 class="modal-title">Choisir une formation</h5>
                <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="list-group">
                    <label class="list-group-item">
                        <input class="form-check-input me-2" type="radio" name="formationRadio" value="Excel d'entreprise"> Excel d'entreprise
                    </label>
                    <label class="list-group-item">
                        <input class="form-check-input me-2" type="radio" name="formationRadio" value="Développement Web"> Développement Web
                    </label>
                    <label class="list-group-item">
                        <input class="form-check-input me-2" type="radio" name="formationRadio" value="Analyse de données"> Analyse de données
                    </label>
                    <label class="list-group-item">
                        <input class="form-check-input me-2" type="radio" name="formationRadio" value="Économétrie appliqué"> Économétrie appliquée
                    </label>
                    <label class="list-group-item">
                        <input class="form-check-input me-2" type="radio" name="formationRadio" value="Machine learning"> Machine learning
                    </label>
                    <label class="list-group-item">
                        <input class="form-check-input me-2" type="radio" name="formationRadio" value="Comptabilité SYSCOHADA"> Comptabilité SYSCOHADA
                    </label>
                    <label class="list-group-item">
                        <input class="form-check-input me-2" type="radio" name="formationRadio" value="Power BI"> Entrepôt de données avec Power BI
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary px-4" onclick="validerFormation()">Confirmer le choix</button>
            </div>
        </div>
    </div>
</div>

<script>
let participants = JSON.parse(localStorage.getItem("participants")) || [];
let editIndex = null;

function validerFormation(){
    const r = document.querySelector('input[name="formationRadio"]:checked');
    if(!r){ alert("Veuillez choisir une formation"); return; }
    document.getElementById("formation").value = r.value;
    bootstrap.Modal.getInstance(document.getElementById("modalFormation")).hide();
}

function enregistrer(){
    const data = {
        nom: document.getElementById("nom").value,
        prenom: document.getElementById("prenom").value,
        postnom: document.getElementById("postnom").value,
        sexe: document.getElementById("sexe").value,
        niveau: document.getElementById("niveau").value,
        telephone: document.getElementById("telephone").value,
        profession: document.getElementById("profession").value,
        formation: document.getElementById("formation").value
    };

    if(Object.values(data).some(v => v === "")){
        alert("Veuillez remplir tous les champs obligatoires.");
        return;
    }

    if(editIndex === null){
        participants.push(data);
    }else{
        participants[editIndex] = data;
        editIndex = null;
    }

    localStorage.setItem("participants", JSON.stringify(participants));
    afficher();
    resetForm();
}

function afficher(){
    const container = document.getElementById("tableParticipants");
    container.innerHTML = "";
    participants.forEach((p,i)=>{
        container.innerHTML += `
        <tr>
            <td>${i+1}</td>
            <td class="fw-bold text-uppercase">${p.nom} ${p.prenom} ${p.postnom}</td>
            <td>${p.telephone}</td>
            <td><span class="badge bg-info text-dark">${p.formation}</span></td>
            <td class="text-center">
                <button class="btn btn-warning btn-sm me-2" onclick="modifier(${i})">
                    <i class="bi bi-pencil-square"></i>
                </button>
                <button class="btn btn-danger btn-sm" onclick="supprimer(${i})">
                    <i class="bi bi-trash"></i>
                </button>
            </td>
        </tr>`;
    });
}

function modifier(i){
    const p = participants[i];
    document.getElementById("nom").value = p.nom;
    document.getElementById("prenom").value = p.prenom;
    document.getElementById("postnom").value = p.postnom;
    document.getElementById("sexe").value = p.sexe;
    document.getElementById("niveau").value = p.niveau;
    document.getElementById("telephone").value = p.telephone;
    document.getElementById("profession").value = p.profession;
    document.getElementById("formation").value = p.formation;
    editIndex = i;
    window.scrollTo({top:0, behavior:"smooth"});
}

function supprimer(i){
    if(confirm("Voulez-vous vraiment supprimer ce participant ?")){
        participants.splice(i,1);
        localStorage.setItem("participants", JSON.stringify(participants));
        afficher();
    }
}

function resetForm(){
    document.querySelectorAll("input, select").forEach(e=>e.value="");
}

function exportExcel(){
    if(participants.length === 0){ alert("La liste est vide"); return; }
    const ws = XLSX.utils.json_to_sheet(participants);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Participants");
    XLSX.writeFile(wb, "Liste_Participants.xlsx");
}

afficher();
</script>

</body>
</html>
