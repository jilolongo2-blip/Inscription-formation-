
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Inscription des Participants</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<style>
body{
    background:#f5f7fb;
    font-family:"Segoe UI", sans-serif;
}
.card{border-radius:12px;}
.photo-preview{
    width:55px;
    height:55px;
    object-fit:cover;
    border-radius:50%;
}
</style>
</head>

<body>

<nav class="navbar navbar-dark bg-dark px-4">
    <span class="navbar-brand fw-bold"><img class="col-lg-2" src="IMG_0213.PNG"></span>
</nav>

<div class="container py-4">

<!-- ================= FORMULAIRE ================= -->
<div class="card shadow-sm mb-4">
<div class="card-header bg-primary text-white fw-bold">
    Formulaire d‚Äôinscription
</div>

<div class="card-body">
<div class="row g-3">

<div class="col-md-4">
    <label class="form-label">Nom</label>
    <input type="text" id="nom" class="form-control">
</div>

<div class="col-md-4">
    <label class="form-label">Pr√©nom</label>
    <input type="text" id="prenom" class="form-control">
</div>

<div class="col-md-4">
    <label class="form-label">Postnom</label>
    <input type="text" id="postnom" class="form-control">
</div>

<div class="col-md-4">
    <label class="form-label">Sexe</label>
    <select id="sexe" class="form-select">
        <option value="">-- Choisir --</option>
        <option>Masculin</option>
        <option>F√©minin</option>
    </select>
</div>

<div class="col-md-4">
    <label class="form-label">Niveau d‚Äô√©tudes</label>
    <select id="niveau" class="form-select">
        <option value="">-- Choisir --</option>
        <option>Secondaire</option>
        <option>Graduat</option>
        <option>Licence</option>
        <option>Master</option>
        <option>Doctorat</option>
    </select>
</div>

<div class="col-md-4">
    <label class="form-label">T√©l√©phone (RDC)</label>
    <input type="tel" id="telephone" class="form-control" placeholder="+24397xxxxxxx">
</div>

<div class="col-md-6">
    <label class="form-label">Adresse</label>
    <input type="text" id="adresse" class="form-control">
</div>

<div class="col-md-6">
    <label class="form-label">Domaine d‚Äô√©tude</label>
    <input type="text" id="domaine" class="form-control">
</div>

<div class="col-md-6">
    <label class="form-label">Profession</label>
    <input type="text" id="profession" class="form-control">
</div>

<div class="col-md-6">
    <label class="form-label">Photo du participant</label>
    <input type="file" id="photo" class="form-control" accept="image/*">
</div>

<div class="col-md-6">
    <label class="form-label">Formation choisie</label>
    <div class="input-group">
        <input type="text" id="formation" class="form-control" readonly>
        <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalFormation">
            Choisir
        </button>
    </div>
</div>

<div class="col-12 text-end">
    <button class="btn btn-success" onclick="enregistrer()">Enregistrer</button>
</div>

</div>
</div>
</div>

<!-- ================= TABLE ================= -->
<div class="card shadow-sm">
<div class="card-header bg-dark text-white fw-bold">
    Liste des participants
</div>

<div class="card-body table-responsive">
<table class="table table-hover align-middle">
<thead class="table-dark">
<tr>
<th>#</th>
<th>Photo</th>
<th>Nom complet</th>
<th>T√©l√©phone</th>
<th>Profession</th>
<th>Formation</th>
<th>Actions</th>
</tr>
</thead>
<tbody id="tableParticipants"></tbody>
</table>
</div>
</div>

</div>

<!-- ================= MODAL FORMATION ================= -->
<div class="modal fade" id="modalFormation">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">

<div class="modal-header bg-dark text-white">
    <h5 class="modal-title">Choisir une formation</h5>
    <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
</div>

<div class="modal-body">
<div class="form-check">
    <input class="form-check-input" type="radio" name="formationRadio" value="D√©veloppement Web">
    <label class="form-check-label">D√©veloppement Web</label>
</div>
<div class="form-check">
    <input class="form-check-input" type="radio" name="formationRadio" value="Comptabilit√© SYSCOHADA">
    <label class="form-check-label">Comptabilit√© SYSCOHADA</label>
</div>
<div class="form-check">
    <input class="form-check-input" type="radio" name="formationRadio" value="Power BI">
    <label class="form-check-label">Power BI</label>
</div>
</div>

<div class="modal-footer">
    <button class="btn btn-success" onclick="validerFormation()">Valider</button>
</div>

</div>
</div>
</div>

<!-- ================= JAVASCRIPT ================= -->
<script>
let participants = JSON.parse(localStorage.getItem("participants")) || [];
let photoBase64 = "";
let editIndex = null;

/* PHOTO */
photo.onchange = function(){
    const file = this.files[0];
    if(!file) return;
    const reader = new FileReader();
    reader.onload = () => photoBase64 = reader.result;
    reader.readAsDataURL(file);
};

/* FORMATION */
function validerFormation(){
    const r = document.querySelector('input[name="formationRadio"]:checked');
    if(!r){ alert("Choisissez une formation"); return; }
    formation.value = r.value;
    bootstrap.Modal.getInstance(modalFormation).hide();
}

/* ENREGISTRER / MODIFIER */
function enregistrer(){
    const telRegex = /^(\+243|0)(81|82|83|84|85|89|97|99)\d{7}$/;
    if(!telRegex.test(telephone.value)){
        alert("Num√©ro RDC invalide");
        return;
    }

    const data = {
        nom: nom.value,
        prenom: prenom.value,
        postnom: postnom.value,
        telephone: telephone.value,
        profession: profession.value,
        formation: formation.value,
        photo: photoBase64 || (editIndex !== null ? participants[editIndex].photo : "")
    };

    if(Object.values(data).includes("")){
        alert("Tous les champs sont obligatoires");
        return;
    }

    if(editIndex === null){
        participants.push(data);
    }else{
        participants[editIndex] = data;
        editIndex = null;
    }

    localStorage.setItem("participants", JSON.stringify(participants));
    afficher();
    resetForm();
}

/* AFFICHAGE */
function afficher(){
    tableParticipants.innerHTML = "";
    participants.forEach((p,i)=>{
        tableParticipants.innerHTML += `
        <tr>
            <td>${i+1}</td>
            <td><img src="${p.photo}" class="photo-preview"></td>
            <td>${p.nom} ${p.prenom} ${p.postnom}</td>
            <td>${p.telephone}</td>
            <td>${p.profession}</td>
            <td>${p.formation}</td>
            <td>
                <button class="btn btn-warning btn-sm" onclick="modifier(${i})">‚úèÔ∏è</button>
                <button class="btn btn-danger btn-sm" onclick="supprimer(${i})">üóëÔ∏è</button>
            </td>
        </tr>`;
    });
}

/* MODIFIER */
function modifier(i){
    const p = participants[i];
    nom.value = p.nom;
    prenom.value = p.prenom;
    postnom.value = p.postnom;
    telephone.value = p.telephone;
    profession.value = p.profession;
    formation.value = p.formation;
    photoBase64 = p.photo;
    editIndex = i;

    document.querySelectorAll('input[name="formationRadio"]').forEach(r=>{
        r.checked = (r.value === p.formation);
    });

    window.scrollTo({top:0, behavior:"smooth"});
}

/* SUPPRIMER */
function supprimer(i){
    if(confirm("Supprimer ce participant ?")){
        participants.splice(i,1);
        localStorage.setItem("participants", JSON.stringify(participants));
        afficher();
        resetForm();
    }
}

/* RESET */
function resetForm(){
    document.querySelectorAll("input, select").forEach(e=>e.value="");
    photoBase64 = "";
    editIndex = null;
    document.querySelectorAll('input[name="formationRadio"]').forEach(r=>r.checked=false);
}

afficher();
</script>

</body>
</html>
